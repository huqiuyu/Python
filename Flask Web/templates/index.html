<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>

    {% macro render_dialog(title, class='dialog') -%}
        <div class="{{ class }}">
            <h2>{{ title }}</h2>
            <div class="contents">
                {{ caller() }}
            </div>
        </div>
    {%- endmacro %}

    {% call render_dialog('Hello World') %}
        This is a simple dialog rendered by using a macro and
        a call block.
    {% endcall %}

    {% macro dump_users(users) -%}
        <ul>
        {%- for user in users %}
            <li><p>{{ user.username|e }}</p>{{ caller(user) }}</li>
        {%- endfor %}
        </ul>
    {%- endmacro %}

    {% set list_of_user=[{'username':'jack', 'realname':'jj', 'description':'...'}, {'username':'mike', 'realname':'mm', 'description':'cc'}] %}

    {% call(user) dump_users(list_of_user) %}
        <dl>
            <dl>Realname</dl>
            <dd>{{ user.realname|e }}</dd>
            <dl>Description</dl>
            <dd>{{ user.description }}</dd>
        </dl>
    {% endcall %}



    {% macro list_users(users) -%}
      <table>
        <tr>
            <th>Name</th>
            <th>Action</th>
        </tr>
        {%- for user in users %}
          <tr>
              <td>{{ user.name |e }}</td>
              {{ caller() }}
          </tr>
        {%- endfor %}
      </table>
    {%- endmacro %}

    {% set users=[{'name':'Tom','gender':'M','age':20},
                  {'name':'John','gender':'M','age':18},
                  {'name':'Mary','gender':'F','age':24}]
    %}

    {% call list_users(users) %}
        <td><input name="delete" type="button" value="Delete"></td>
    {% endcall %}

    {% macro list_users(users) -%}
      <table>
        <tr>
            <th>Name</th>
            <th>Gender</th>
            <th>Action</th>
        </tr>
        {%- for user in users %}
          <tr>
              <td>{{ user.name |e }}</td>
              {{ caller(user.gender) }}
          </tr>
        {%- endfor %}
      </table>
    {%- endmacro %}

    {% call(gender) list_users(users) %}
        <td>
            {% if gender == 'M' %}
                <img src="https://ss2.bdstatic.com/70cFvnSh_Q1YnxGkpoWK1HF6hhy/it/u=2321671816,211301890&fm=200&gp=0.jpg" width="20px">
                {% else %}
                <img src="https://ss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=2714687920,42745578&fm=27&gp=0.jpg" width="20px">
            {% endif %}
        </td>
        <td><input name="delete" type="button" value="Delete">
        </td>
    {% endcall %}


</body>
</html>